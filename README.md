# Keenetic WireGuard + NFQWS DPI Bypass

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ **NFQWS** –Ω–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ **Keenetic** –¥–ª—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ **WireGuard-handshake** (WARP / AmneziaWG-–ø–æ–¥–æ–±–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏) –∏ –æ–±—Ö–æ–¥–∞ DPI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –ª–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —à–∞–±–ª–æ–Ω–æ–≤.

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# –ù–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ Keenetic —á–µ—Ä–µ–∑ SSH (–æ—Ç root/admin):
curl -fsSL https://raw.githubusercontent.com/ldeprive3-spec/keenetic-wg-nfqws/main/install.sh | sh
```

–°–∫—Ä–∏–ø—Ç —Å–∞–º:
- –ø—Ä–æ–≤–µ—Ä–∏—Ç –Ω–∞–ª–∏—á–∏–µ IPv6, Netfilter, WireGuard –∏ Entware;
- —É—Å—Ç–∞–Ω–æ–≤–∏—Ç `nfqws-keenetic` —á–µ—Ä–µ–∑ `opkg`;
- —Å–æ–∑–¥–∞—Å—Ç —Ä–∞–±–æ—á–∏–π –∫–æ–Ω—Ñ–∏–≥ NFQWS (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏);
- –≤–∫–ª—é—á–∏—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∏ —Å—Ç–∞—Ä—Ç—É–µ—Ç NFQWS.

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å WireGuard (WARP-–∫–æ–Ω—Ñ–∏–≥) –Ω–∞ —Å–∞–º–æ–º Keenetic.

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Keenetic OS **5.0.4+**
- –í–∫–ª—é—á—ë–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  - IPv6
  - Netfilter (–º–æ–¥—É–ª–∏ —è–¥—Ä–∞ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã Netfilter)
  - WireGuard VPN
  - Entware
  - SSH-—Å–µ—Ä–≤–µ—Ä
- –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:
  - 512 MB —Å–≤–æ–±–æ–¥–Ω–æ–π RAM
  - USB-–Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å 1 GB+ –¥–ª—è Entware

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:  
**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã ‚Üí –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**.

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Keenetic

1. –ó–∞–π—Ç–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://192.168.1.1`
2. –û—Ç–∫—Ä—ã—Ç—å: **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã ‚Üí –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**
3. –û—Ç–º–µ—Ç–∏—Ç—å:

   ```text
   ‚òë –ü—Ä–æ—Ç–æ–∫–æ–ª IPv6
   ‚òë –ú–æ–¥—É–ª–∏ —è–¥—Ä–∞ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã Netfilter
   ‚òë WireGuard VPN
   ‚òë Entware
   ‚òë SSH —Å–µ—Ä–≤–µ—Ä
   ```

4. –ù–∞–∂–∞—Ç—å **¬´–û–±–Ω–æ–≤–∏—Ç—å KeeneticOS¬ª**, –¥–æ–∂–¥–∞—Ç—å—Å—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ (5‚Äì10 –º–∏–Ω—É—Ç).
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ SSH:

   ```bash
   ssh admin@192.168.1.1

   ip -6 addr show        # –µ—Å—Ç—å inet6-–∞–¥—Ä–µ—Å–∞
   lsmod | grep nf_queue  # –µ—Å—Ç—å nf_queue/nfnetlink
   show interface | grep -i wireguard
   opkg --version         # Entware —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   ```

---

## üåê –ü–æ–ª—É—á–µ–Ω–∏–µ WARP / WireGuard-–∫–æ–Ω—Ñ–∏–≥–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: WARP —á–µ—Ä–µ–∑ WireGuard

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤ WARP (–Ω–∞–ø—Ä–∏–º–µ—Ä, warpgen.net).  
2. –í—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º **WireGuard** (–æ–±—ã—á–Ω—ã–π, –±–µ–∑ AWG 1.5).
3. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ.

```bash
ssh admin@192.168.1.1

mkdir -p /opt/etc/wireguard
nano /opt/etc/wireguard/warp.conf
# –í—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥ ‚Üí Ctrl+X ‚Üí Y ‚Üí Enter
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: AmneziaVPN + AWG 1.5 (–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞—Ö)

- –ù–∞ –ü–ö/—Ç–µ–ª–µ—Ñ–æ–Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ AmneziaVPN** –∏ awg1.5-–∫–æ–Ω—Ñ–∏–≥ –∏–∑ warpgen.net.  
- –ù–∞ —Å–∞–º–æ–º Keenetic –ø—Ä–∏ —ç—Ç–æ–º –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—ã—á–Ω—ã–π WireGuard-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å; –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä awg1.5 –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç, –æ–Ω –≤–∏–¥–∏—Ç –æ–±—ã—á–Ω—ã–π WireGuard-—Ç—Ä–∞—Ñ–∏–∫ —Å –æ–±—Ñ—É—Å–∫–∞—Ü–∏–µ–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞.

---

## üåê –í–∫–ª—é—á–µ–Ω–∏–µ WireGuard –Ω–∞ Keenetic

–ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:

1. **–ò–Ω—Ç–µ—Ä–Ω–µ—Ç ‚Üí –î—Ä—É–≥–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ‚Üí WireGuard**
2. –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–Ω–æ) –∏–ª–∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ `warp.conf`.
3. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ **¬´–í–∫–ª—é—á–µ–Ω–æ¬ª**.
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ç–∞—Ç—É—Å —Å—Ç–∞–ª **Up**, –∞ —Å—á—ë—Ç—á–∏–∫–∏ RX/TX —Ä–∞—Å—Ç—É—Ç.

–ß–µ—Ä–µ–∑ CLI:

```bash
ssh admin@192.168.1.1

# –í–∫–ª—é—á–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–ø—Ä–∏–º–µ—Ä: Wireguard0)
interface Wireguard0 enable

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
show interface Wireguard0
```

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å AmneziaWG-–ø–æ–¥–æ–±–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (asc) ‚Äî –ø—Ä–∏–º–µ–Ω—è–µ—à—å –∏—Ö –æ—Ç–¥–µ–ª—å–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:

```bash
interface Wireguard0 wireguard asc Jc Jmin Jmax S1 S2 H1 H2 H3 H4
system configuration save
interface Wireguard0 disable
interface Wireguard0 enable
```

---

## üõ°Ô∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç NFQWS

–°–∫—Ä–∏–ø—Ç `install.sh`:

- –°—Ç–∞–≤–∏—Ç `nfqws-keenetic` —á–µ—Ä–µ–∑ Entware.
- –°–æ–∑–¥–∞—ë—Ç `/opt/etc/nfqws/nfqws.conf` —Å **—Å—Ä–µ–¥–Ω–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º** DPI-desync:

  ```text
  --dpi-desync=fake,split2
  --dpi-desync-repeats=4
  --dpi-desync-ttl=3
  --dpi-desync-fooling=badsum
  ```

- –í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ `/opt/etc/init.d/S51nfqws`.
- –ó–∞–ø—É—Å–∫–∞–µ—Ç NFQWS —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.

NFQWS –Ω–∞—Ü–µ–ª–µ–Ω –Ω–∞ –æ–±—Ñ—É—Å–∫–∞—Ü–∏—é –ø–∞–∫–µ—Ç–æ–≤ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (WireGuard handshake), —á—Ç–æ–±—ã DPI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –Ω–µ –º–æ–≥ –Ω–∞–¥—ë–∂–Ω–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç—É–Ω–Ω–µ–ª—å.

---

## ‚öôÔ∏è –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

- `install.sh`  
  –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ NFQWS –Ω–∞ Keenetic:
  - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è;
  - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `nfqws-keenetic`;
  - —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ —Å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏;
  - –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –∏ —Å—Ç–∞—Ä—Ç.

- `nfqws-config.sh`  
  –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π –æ–±—Ñ—É—Å–∫–∞—Ü–∏–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
  - `weak` ‚Äî —Å–ª–∞–±–∞—è –æ–±—Ñ—É—Å–∫–∞—Ü–∏—è (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞);
  - `medium` ‚Äî —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è (–ø—Ä–æ—Ñ–∏–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é);
  - `aggressive` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞ (—Ü–µ–Ω–∞ ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ–µ –ø–∞–¥–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏);
  - –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞ NFQWS –∏ WireGuard;
  - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤.

- `README.md`  
  –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é (—ç—Ç–æ—Ç —Ñ–∞–π–ª).

- `CHANGELOG.md`  
  –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

- `LICENSE`  
  MIT License.

- `.gitignore`  
  –ë–∞–∑–æ–≤—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è (–ª–æ–≥–∏, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã, IDE-–º—É—Å–æ—Ä).

---

## üîÑ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ NFQWS

```bash
# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
/opt/etc/init.d/S51nfqws status

# –ó–∞–ø—É—Å–∫ / –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ / —Ä–µ—Å—Ç–∞—Ä—Ç
/opt/etc/init.d/S51nfqws start
/opt/etc/init.d/S51nfqws stop
/opt/etc/init.d/S51nfqws restart

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π
./nfqws-config.sh          # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
./nfqws-config.sh status   # —Å—Ç–∞—Ç—É—Å
./nfqws-config.sh medium   # –≤–∫–ª—é—á–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—å
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞

–ù–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ:

```bash
show interface Wireguard0
ps | grep nfqws
```

–ù–∞ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:

- https://whatismyipaddress.com ‚Äî IP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å Cloudflare, –∞ –Ω–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
- https://dnsleaktest.com ‚Äî DNS –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å Cloudflare (–∏–ª–∏ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞).
- https://speedtest.net ‚Äî —Å–∫–æ—Ä–æ—Å—Ç—å –±–ª–∏–∑–∫–∞ –∫ —à—Ç–∞—Ç–Ω–æ–π (–ø—Ä–∏ medium/weak –ø—Ä–æ—Ñ–∏–ª–µ).

---

## üêõ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ Troubleshooting

- **WireGuard –Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è**
  - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `warp.conf`;
  - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ (—Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ñ–∏–≥–∏ WARP –º–æ–≥—É—Ç —É–º–µ—Ä–µ—Ç—å –ø—Ä–∏ —Å–º–µ–Ω–µ endpoint).

- **NFQWS –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç**
  - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å `lsmod | grep nf_queue`;
  - –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞–∫–µ—Ç: `opkg remove nfqws-keenetic && opkg install nfqws-keenetic`;
  - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Ä–æ—É—Ç–µ—Ä.

- **–ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∂–µ—Å—Ç–∫–æ —Ä–≤–∞—Ç—å —Ç—É–Ω–Ω–µ–ª—å**
  - –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å `nfqws-config.sh aggressive`;
  - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π WARP-–∫–æ–Ω—Ñ–∏–≥;
  - –ø—Ä–∏ —Å–æ–≤—Å–µ–º –∂—ë—Å—Ç–∫–æ–º DPI ‚Äî —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å AmneziaVPN/—Å–≤–æ–π —Å–µ—Ä–≤–µ—Ä.

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ –ª–∏—Ü–µ–Ω–∑–∏–∏ **MIT** (—Å–º. —Ñ–∞–π–ª `LICENSE`).
